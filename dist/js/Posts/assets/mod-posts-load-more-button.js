var Modularity=Modularity||{};Modularity.Posts=Modularity.Posts||{},Modularity.Posts.LoadMoreButton=function(o){function t(){this.init()}return t.prototype.init=function(){o(document).on("click",".js-mod-posts-load-more",function(t){var e=o(t.target),r=JSON.parse(e.attr("data-mod-posts-load-more"));if(this.attributesExists(["postsPerPage","offset","target","ajaxUrl","nonce","bladeTemplate"],Object.keys(r))){var s=o(r.target)[0];if(void 0===s)throw'Error: Could not find target "'+r.target+'"';this.toggleLoader(e),this.loadMorePosts(e,s,r)}}.bind(this))},t.prototype.toggleLoader=function(o){if(o.hasClass("hidden"))return o.removeClass("hidden"),void this.removeLoader(o);o.addClass("hidden"),o.after('<div class="loading"><div></div><div></div><div></div><div></div></div>')},t.prototype.loadMorePosts=function(t,e,r){console.log("loadMorePosts()");var s=r;s.action="mod_posts_load_more",o.ajax({type:"post",url:s.ajaxUrl,data:s,success:function(s,a){return console.log(s),console.log(a),"success"==a?(o(e).append(s.join("")),r.postsPerPage>s.length?(this.removeLoader(t),void t.remove()):(this.toggleLoader(t),r.offset=parseInt(r.offset)+parseInt(r.postsPerPage),void t.attr("data-mod-posts-load-more",JSON.stringify(r)))):"nocontent"==a?(this.removeLoader(t),t.after("<p>No more posts to showâ€¦</p>"),void t.remove()):void 0}.bind(this),error:function(o,t,e){console.log(e)}})},t.prototype.removeLoader=function(t){o(t.next()).hasClass("loading")&&t.next().remove()},t.prototype.attributesExists=function(o,t){var e=!0;return o.forEach((function(o){if(!t.includes(o))throw e=!1,'ValidationError: Missing required data-attribute key "'+o+'"'})),e},new t}(jQuery);