{"version":3,"sources":["prompt/modal.js","helpers/widget.js","helpers/helpers.js","editor/validate.js","editor/thickbox.js","editor/module.js","editor/dragAndDrop.js","editor/autosave.js","modularity.js"],"names":["$","isOpen","Modal","handleEvents","prototype","open","url","addClass","append","modularityAdminLanguage","close","removeClass","remove","document","on","e","preventDefault","bind","jQuery","editingWidget","Widget","target","parents","importUrl","Modularity","Editor","Module","getImportUrl","postType","find","val","editingModule","closest","Thickbox","postAction","Prompt","el","attr","indexOf","isEditingWidget","updateWidget","widget","data","html","post_id","title","Helpers","uuid","Math","random","toString","substr","hasErrors","errorClass","Validate","run","checkRequired","required","each","index","element","length","one","css","modulePostCreated","postId","module","isEditingModule","request","action","id","post","ajaxurl","response","ID","post_title","updateModule","Autosave","save","initCompleted","thickboxOptions","is_thickbox","pagenow","loadModules","modularity_post_id","sidebar","modules","sidebarElement","key","hidden","incompability","sidebar_incompability","isEmptyObject","JSON","stringify","addModule","post_type","post_type_name","columnWidth","isDeprecated","getThickBoxUrl","base","querystring","admin_url","param","moduleId","moduleName","moduleTitle","deprecated","thickboxUrl","isHidden","sidebarId","itemRowId","langhide","width","widthOptions","langedit","langimport","langremove","item","sortable","change","text","removeModule","confirm","actionRemove","sortableIn","DragAndDrop","init","setupDraggable","setupDroppable","setupSortable","handle","connectWith","placeholder","start","ui","validTargetAreas","parse","includes","parent","error","console","log","stop","newName","replace","draggable","appendTo","containment","scroll","helper","revert","revertDuration","event","droppable","accept","hoverClass","drop","appendModule","undefined","selector","serializeObject","isChecked","is","value","alert","shiftKey","siblings","wp","autosave","window","unbind","server","triggerSave","ajaxComplete","ready","offset","scrollTop","top","hasClass","hide","show","trigger"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;eACgB,UAAUA,CAAV,EAAa;AAC5B,MAAIC,MAAM,GAAG,KAAb;;AAEA,WAASC,KAAT,GAAiB;AAChB,SAAKC,YAAL;AACA;;AAEDD,EAAAA,KAAK,CAACE,SAAN,CAAgBC,IAAhB,GAAuB,UAAUC,GAAV,EAAe;AACrCN,IAAAA,CAAC,CAAC,MAAD,CAAD,CAAUO,QAAV,CAAmB,uBAAnB,EAA4CC,MAA5C,qPAKiBC,uBAAuB,CAACC,KALzC,gRAQiEJ,GARjE;AAcAL,IAAAA,MAAM,GAAG,IAAT;AACA,GAhBD;;AAkBAC,EAAAA,KAAK,CAACE,SAAN,CAAgBM,KAAhB,GAAwB,YAAY;AACnCV,IAAAA,CAAC,CAAC,MAAD,CAAD,CAAUW,WAAV,CAAsB,uBAAtB;AACAX,IAAAA,CAAC,CAAC,mBAAD,CAAD,CAAuBY,MAAvB;AACAX,IAAAA,MAAM,GAAG,KAAT;AACA,GAJD;;AAMAC,EAAAA,KAAK,CAACE,SAAN,CAAgBD,YAAhB,GAA+B,YAAY;AAC1CH,IAAAA,CAAC,CAACa,QAAD,CAAD,CAAYC,EAAZ,CACC,OADD,EAEC,wCAFD,EAGC,UAAUC,CAAV,EAAa;AACZA,MAAAA,CAAC,CAACC,cAAF;AACA,WAAKN,KAAL;AACA,KAHD,CAGEO,IAHF,CAGO,IAHP,CAHD;AAQA,GATD;;AAWA,SAAO,IAAIf,KAAJ,EAAP;AACA,CA3Cc,CA2CZgB,MA3CY;;;;;;;;;;;ACHf;;AACA;eACgB,UAAUlB,CAAV,EAAa;AAC5B,MAAImB,aAAa,GAAG,KAApB;;AAEA,WAASC,MAAT,GAAkB;AACjBpB,IAAAA,CAAC,CAAC,YAAY;AACb;AACAA,MAAAA,CAAC,CAACa,QAAD,CAAD,CAAYC,EAAZ,CACC,OADD,EAEC,8CAFD,EAGC,UAAUC,CAAV,EAAa;AACZA,QAAAA,CAAC,CAACC,cAAF;AAEAG,QAAAA,aAAa,GAAGnB,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYC,OAAZ,CAAoB,gBAApB,CAAhB;AAEA,YAAMC,SAAS,GAAGC,UAAU,CAACC,MAAX,CAAkBC,MAAlB,CAAyBC,YAAzB,CAAsC;AACvDC,UAAAA,QAAQ,EAAE5B,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CACRC,OADQ,CACA,gBADA,EAERO,IAFQ,CAEH,uCAFG,EAGRC,GAHQ;AAD6C,SAAtC,CAAlB;AAOAN,QAAAA,UAAU,CAACC,MAAX,CAAkBC,MAAlB,CAAyBK,aAAzB,GAAyC/B,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CACxC,gBADwC,CAAzC;AAIAR,QAAAA,UAAU,CAACC,MAAX,CAAkBQ,QAAlB,CAA2BC,UAA3B,GAAwC,eAAxC;AACAV,QAAAA,UAAU,CAACW,MAAX,CAAkBjC,KAAlB,CAAwBG,IAAxB,CAA6BkB,SAA7B;AACA,OArBF;AAwBA;;AACAvB,MAAAA,CAAC,CAACa,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,EAAwB,qCAAxB,EAA+D,UAC9DC,CAD8D,EAE7D;AACDA,QAAAA,CAAC,CAACC,cAAF;AAEA,YAAMoB,EAAE,GAAGpC,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,GAApB,CAAX;;AACA,YAAII,EAAE,CAACC,IAAH,CAAQ,MAAR,EAAgBC,OAAhB,CAAwB,UAAxB,IAAsC,CAAC,CAA3C,EAA8C;AAC7Cd,UAAAA,UAAU,CAACC,MAAX,CAAkBQ,QAAlB,CAA2BC,UAA3B,GAAwC,MAAxC;AACA;;AAEDH,QAAAA,aAAa,GAAG/B,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,IAApB,CAAhB;AAEAR,QAAAA,UAAU,CAACW,MAAX,CAAkBjC,KAAlB,CAAwBG,IAAxB,CAA6BL,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,GAApB,EAAyBK,IAAzB,CAA8B,MAA9B,CAA7B;AACA,OAbD;AAcA,KAzCA,CAAD;AA0CA;;AAEDjB,EAAAA,MAAM,CAAChB,SAAP,CAAiBmC,eAAjB,GAAmC,YAAY;AAC9C,WAAOpB,aAAP;AACA,GAFD;;AAIAC,EAAAA,MAAM,CAAChB,SAAP,CAAiBoC,YAAjB,GAAgC,UAAUC,MAAV,EAAkBC,IAAlB,EAAwB;AACvD1C,IAAAA,CAAC,CAACyC,MAAD,CAAD,CAAUZ,IAAV,CAAe,mCAAf,EAAoDc,IAApD,CAAyDD,IAAI,CAACE,OAA9D;AACA5C,IAAAA,CAAC,CAACyC,MAAD,CAAD,CAAUZ,IAAV,CAAe,8BAAf,EAA+CC,GAA/C,CAAmDY,IAAI,CAACE,OAAxD;AACA5C,IAAAA,CAAC,CAACyC,MAAD,CAAD,CACEZ,IADF,CACO,gCADP,EAEEQ,IAFF,CAGE,MAHF,EAIE,mBAAmBK,IAAI,CAACE,OAAxB,GAAkC,+BAJpC,EAMEjC,WANF,CAMc,QANd;AAOAX,IAAAA,CAAC,CAACyC,MAAD,CAAD,CAAUZ,IAAV,CAAe,sCAAf,EAAuDc,IAAvD,CAA4DD,IAAI,CAACG,KAAjE;AACA7C,IAAAA,CAAC,CAACyC,MAAD,CAAD,CAAUZ,IAAV,CAAe,iCAAf,EAAkDC,GAAlD,CAAsDY,IAAI,CAACG,KAA3D;AACA,GAZD;;AAcA,SAAO,IAAIzB,MAAJ,EAAP;AACA,CAnEc,CAmEZF,MAnEY;;;;;;;;;;;ACFf;;AACA;;AACA;;AACA;eACgB,UAAUlB,CAAV,EAAa;AAC5B,WAAS8C,OAAT,GAAmB;AAClB9C,IAAAA,CAAC,CAAC,YAAY,CAAE,CAAd,CAAeiB,IAAf,CAAoB,IAApB,CAAD,CAAD;AACA;;AAED6B,EAAAA,OAAO,CAAC1C,SAAR,CAAkB2C,IAAlB,GAAyB,YAAY;AACpC,WAAOC,IAAI,CAACC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,MAA3B,CAAkC,CAAlC,EAAqC,CAArC,CAAP;AACA,GAFD;;AAIA,SAAO,IAAIL,OAAJ,EAAP;AACA,CAVc,CAUZ5B,MAVY;;;;;;;;;;;eCJC,UAAUlB,CAAV,EAAa;AAC5B,MAAIoD,SAAS,GAAG,KAAhB;AACA,MAAMC,UAAU,GAAG,kBAAnB;;AAEA,WAASC,QAAT,GAAoB;AACnB,SAAKnD,YAAL;AACA;AAED;;;;;;;AAKAmD,EAAAA,QAAQ,CAAClD,SAAT,CAAmBmD,GAAnB,GAAyB,YAAY;AACpCH,IAAAA,SAAS,GAAG,KAAZ;AACA,SAAKI,aAAL;AACA,GAHD;AAKA;;;;;;;AAKAF,EAAAA,QAAQ,CAAClD,SAAT,CAAmBoD,aAAnB,GAAmC,YAAY;AAC9C,QAAMC,QAAQ,GAAGzD,CAAC,CAAC,YAAD,CAAlB;AACAyD,IAAAA,QAAQ,CAAC9C,WAAT,CAAqB0C,UAArB;AAEAI,IAAAA,QAAQ,CAACC,IAAT,CAAc,UAAUC,KAAV,EAAiBC,OAAjB,EAA0B;AACvC,UAAI5D,CAAC,CAAC4D,OAAD,CAAD,CAAW9B,GAAX,GAAiB+B,MAAjB,KAA4B,CAAhC,EAAmC;AAClC7D,QAAAA,CAAC,CAAC4D,OAAD,CAAD,CAAWtC,OAAX,CAAmB,IAAnB,EAAyBf,QAAzB,CAAkC8C,UAAlC;AAEArD,QAAAA,CAAC,CAAC4D,OAAD,CAAD,CAAWE,GAAX,CAAe,QAAf,EAAyB,UAAU/C,CAAV,EAAa;AACrCf,UAAAA,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYC,OAAZ,CAAoB,IAApB,EAA0BX,WAA1B,CAAsC0C,UAAtC;AACA,SAFD;AAIAD,QAAAA,SAAS,GAAG,IAAZ;AACA;AACD,KAVD;AAWA,GAfD;AAiBA;;;;;;;AAKAE,EAAAA,QAAQ,CAAClD,SAAT,CAAmBD,YAAnB,GAAkC,YAAY;AAC7CH,IAAAA,CAAC,CAACa,QAAD,CAAD,CAAYC,EAAZ,CACC,OADD,EAEC,wCAFD,EAGC,YAAY;AACX,WAAKyC,GAAL;;AAEA,UAAIH,SAAJ,EAAe;AACdpD,QAAAA,CAAC,CAAC,wCAAD,CAAD,CAA4C+D,GAA5C,CACC,YADD,EAEC,QAFD;AAIA,eAAO,KAAP;AACA;;AAED,aAAO,IAAP;AACA,KAZD,CAYE9C,IAZF,CAYO,IAZP,CAHD;AAiBA,GAlBD;;AAoBA,SAAO,IAAIqC,QAAJ,EAAP;AACA,CAlEc,CAkEZpC,MAlEY;;;;;;;;;;;eCAC,UAAUlB,CAAV,EAAa;AAC5B;;;;;;;AAOA,MAAMkC,UAAU,GAAG,KAAnB;;AAEA,WAASD,QAAT,GAAoB,CAAE;;AAEtBA,EAAAA,QAAQ,CAAC7B,SAAT,CAAmB4D,iBAAnB,GAAuC,UAAUC,MAAV,EAAkB;AACxDzC,IAAAA,UAAU,CAACW,MAAX,CAAkBjC,KAAlB,CAAwBQ,KAAxB;AAEA,QAAMwD,MAAM,GAAG1C,UAAU,CAACC,MAAX,CAAkBC,MAAlB,CAAyByC,eAAzB,EAAf;AAEA,QAAMC,OAAO,GAAG;AACfC,MAAAA,MAAM,EAAE,UADO;AAEfC,MAAAA,EAAE,EAAEL;AAFW,KAAhB;AAKAjE,IAAAA,CAAC,CAACuE,IAAF,CACCC,OADD,EAECJ,OAFD,EAGC,UAAUK,QAAV,EAAoB;AACnB,UAAM/B,IAAI,GAAG;AACZE,QAAAA,OAAO,EAAE6B,QAAQ,CAACC,EADN;AAEZ7B,QAAAA,KAAK,EAAE4B,QAAQ,CAACE;AAFJ,OAAb;AAKAnD,MAAAA,UAAU,CAACC,MAAX,CAAkBC,MAAlB,CAAyBkD,YAAzB,CAAsCV,MAAtC,EAA8CxB,IAA9C;AACAlB,MAAAA,UAAU,CAACC,MAAX,CAAkBoD,QAAlB,CAA2BC,IAA3B,CAAgC,MAAhC;AACA,KAXF,EAYC,MAZD;AAcA,GAxBD;;AA0BA,SAAO,IAAI7C,QAAJ,EAAP;AACA,CAvCc,CAuCZf,MAvCY;;;;;;;;;;;ACAf;;AACA;;AACA;;AACA;;AACA;eACgB,UAAUlB,CAAV,EAAa;AAC5B,MAAM+E,aAAa,GAAG,KAAtB;AAEA;;;;;;AAKA,MAAMC,eAAe,GAAG;AACvBC,IAAAA,WAAW,EAAE;AADU,GAAxB;AAIA,MAAIlD,aAAa,GAAG,KAApB;;AAEA,WAASL,MAAT,GAAkB;AACjB1B,IAAAA,CAAC,CACA,YAAY;AACX,UACC,OAAOkF,OAAP,KAAmB,WAAnB,IACAA,OAAO,KAAK,8BAFb,EAGE;AACD,aAAK/E,YAAL;AACA,aAAKgF,WAAL,CAAiBC,kBAAjB;AACA;AACD,KARD,CAQEnE,IARF,CAQO,IARP,CADA,CAAD;AAWA;AAED;;;;;;;;AAMAS,EAAAA,MAAM,CAACtB,SAAP,CAAiB+E,WAAjB,GAA+B,UAAUlB,MAAV,EAAkB;AAChD,QAAMG,OAAO,GAAG;AACfC,MAAAA,MAAM,EAAE,kBADO;AAEfC,MAAAA,EAAE,EAAEL;AAFW,KAAhB;AAKAjE,IAAAA,CAAC,CAACuE,IAAF,CACCC,OADD,EAECJ,OAFD,EAGC,UAAUK,QAAV,EAAoB;AACnBzE,MAAAA,CAAC,CAAC0D,IAAF,CACCe,QADD,EAEC,UAAUY,OAAV,EAAmBC,OAAnB,EAA4B;AAC3B,YAAMC,cAAc,GAAGvF,CAAC,CACvB,4CAA4CqF,OAA5C,GAAsD,IAD/B,CAAxB;AAIArF,QAAAA,CAAC,CAAC0D,IAAF,CACC4B,OAAO,CAACA,OADT,EAEC,UAAUE,GAAV,EAAe9C,IAAf,EAAqB;AACpB,cAAIA,IAAI,CAAC+C,MAAL,KAAgB,MAApB,EAA4B;AAC3B/C,YAAAA,IAAI,CAAC+C,MAAL,GAAc,IAAd;AACA;;AAED,cAAMC,aAAa,GAClB,OAAOhD,IAAI,CAACiD,qBAAZ,KAAsC,WAAtC,IACA,CAAC3F,CAAC,CAAC4F,aAAF,CAAgBlD,IAAI,CAACiD,qBAArB,CADD,GAEGE,IAAI,CAACC,SAAL,CAAepD,IAAI,CAACiD,qBAApB,CAFH,GAGG,EAJJ;AAKA,eAAKI,SAAL,CACCR,cADD,EAEC7C,IAAI,CAACsD,SAFN,EAGCtD,IAAI,CAACuD,cAHN,EAICvD,IAAI,CAACiC,UAJN,EAKCjC,IAAI,CAACgC,EALN,EAMChC,IAAI,CAAC+C,MANN,EAOC/C,IAAI,CAACwD,WAPN,EAQCxD,IAAI,CAACyD,YARN,EASCT,aATD;AAWA,SArBD,CAqBEzE,IArBF,CAqBO,IArBP,CAFD;AA0BAsE,QAAAA,cAAc,CAAC5E,WAAf,CAA2B,oBAA3B;AACA,OAhCD,CAgCEM,IAhCF,CAgCO,IAhCP,CAFD;AAqCA,WAAK8D,aAAL,GAAqB,IAArB;AACA/E,MAAAA,CAAC,CAAC,0BAAD,CAAD,CAA8BW,WAA9B,CAA0C,oBAA1C;AACA,KAxCD,CAwCEM,IAxCF,CAwCO,IAxCP,CAHD,EA4CC,MA5CD;AA8CA,GApDD;AAsDA;;;;;;;AAKAS,EAAAA,MAAM,CAACtB,SAAP,CAAiB+D,eAAjB,GAAmC,YAAY;AAC9C,WAAOpC,aAAP;AACA,GAFD;AAIA;;;;;;;;;AAOAL,EAAAA,MAAM,CAACtB,SAAP,CAAiBgG,cAAjB,GAAkC,UAAU/B,MAAV,EAAkB3B,IAAlB,EAAwB;AACzD,QAAI2D,IAAI,GAAG,EAAX;AACA,QAAMC,WAAW,GAAG,EAApB;;AAEA,YAAQjC,MAAR;AACC,WAAK,KAAL;AACCgC,QAAAA,IAAI,GAAG,cAAP;AACA;;AAED,WAAK,MAAL;AACCA,QAAAA,IAAI,GAAG,UAAP;AACA;AAPF;;AAUA,QAAI,OAAO3D,IAAI,CAACuB,MAAZ,KAAuB,QAA3B,EAAqC;AACpCqC,MAAAA,WAAW,CAAC/B,IAAZ,GAAmB7B,IAAI,CAACuB,MAAxB;AACAqC,MAAAA,WAAW,CAACjC,MAAZ,GAAqB,MAArB;AACA;;AAED,QAAI,OAAO3B,IAAI,CAACd,QAAZ,KAAyB,QAA7B,EAAuC;AACtC0E,MAAAA,WAAW,CAACN,SAAZ,GAAwBtD,IAAI,CAACd,QAA7B;AACA;;AAED,WACC2E,SAAS,GACTF,IADA,GAEA,GAFA,GAGArG,CAAC,CAACwG,KAAF,CAAQF,WAAR,CAHA,GAIA,GAJA,GAKAtG,CAAC,CAACwG,KAAF,CAAQxB,eAAR,CAND;AAQA,GA/BD;;AAiCAtD,EAAAA,MAAM,CAACtB,SAAP,CAAiBuB,YAAjB,GAAgC,UAAUe,IAAV,EAAgB;AAC/C,QAAM2D,IAAI,GAAG,UAAb;AACA,QAAMC,WAAW,GAAG,EAApB;AAEAA,IAAAA,WAAW,CAACN,SAAZ,GAAwBtD,IAAI,CAACd,QAA7B;AAEA,WACC2E,SAAS,GACTF,IADA,GAEA,GAFA,GAGArG,CAAC,CAACwG,KAAF,CAAQF,WAAR,CAHA,GAIA,GAJA,GAKAtG,CAAC,CAACwG,KAAF,CAAQxB,eAAR,CAND;AAQA,GAdD;AAgBA;;;;;;;;;;;;;;;;AAcAtD,EAAAA,MAAM,CAACtB,SAAP,CAAiB2F,SAAjB,GAA6B,UAC5B1E,MAD4B,EAE5BoF,QAF4B,EAG5BC,UAH4B,EAI5BC,WAJ4B,EAK5B1C,MAL4B,EAM5BwB,MAN4B,EAO5BS,WAP4B,EAQ5BC,YAR4B,EAS5BT,aAT4B,EAU3B;AACDiB,IAAAA,WAAW,GAAG,OAAOA,WAAP,KAAuB,WAAvB,GAAqC,OAAOA,WAA5C,GAA0D,EAAxE;AACA1C,IAAAA,MAAM,GAAG,OAAOA,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,EAAlD;AACAiC,IAAAA,WAAW,GAAG,OAAOA,WAAP,KAAuB,WAAvB,GAAqCA,WAArC,GAAmD,EAAjE;AACAU,IAAAA,UAAU,GACTT,YAAY,KAAK,IAAjB,6EACkE1F,uBAAuB,CAACmG,UAD1F,gBAEG,EAHJ;AAIAlB,IAAAA,aAAa,GAAG,OAAOA,aAAP,KAAyB,WAAzB,GAAuCA,aAAvC,GAAuD,EAAvE,CARC,CAUD;;AACA,QAAImB,WAAW,GAAG,KAAKT,cAAL,CAAoB,KAApB,EAA2B;AAC5CxE,MAAAA,QAAQ,EAAE6E;AADkC,KAA3B,CAAlB,CAXC,CAeD;;AACAjF,IAAAA,UAAU,CAACC,MAAX,CAAkBQ,QAAlB,CAA2BC,UAA3B,GAAwC,KAAxC;;AAEA,QAAI+B,MAAJ,EAAY;AACX4C,MAAAA,WAAW,GAAG,KAAKT,cAAL,CAAoB,MAApB,EAA4B;AACzCnC,QAAAA,MAAM,EAANA;AADyC,OAA5B,CAAd;AAIAzC,MAAAA,UAAU,CAACC,MAAX,CAAkBQ,QAAlB,CAA2BC,UAA3B,GAAwC,MAAxC;AACA,KAxBA,CA0BD;;;AACA,QAAMX,SAAS,GAAG,KAAKI,YAAL,CAAkB;AACnCC,MAAAA,QAAQ,EAAE6E;AADyB,KAAlB,CAAlB,CA3BC,CA+BD;;AACA,QAAIK,QAAQ,GAAG,EAAf;;AACA,QAAIrB,MAAM,KAAK,IAAf,EAAqB;AACpBqB,MAAAA,QAAQ,GAAG,SAAX;AACA;;AAED,QAAMC,SAAS,GAAG/G,CAAC,CAACqB,MAAD,CAAD,CAAUqB,IAAV,CAAe,SAAf,CAAlB;AACA,QAAMsE,SAAS,GAAGxF,UAAU,CAACsB,OAAX,CAAmBC,IAAnB,EAAlB;AAEA,QAAMJ,IAAI,2BAAmBsB,MAAnB,iCAA8CwC,QAA9C,2CAAqFP,WAArF,4CAAiIR,aAAjI,gOAA8VgB,UAA9V,qCAAmYE,UAAnY,6EAA8cD,WAA9c,mKAA6mBI,SAA7mB,eAA2nBC,SAA3nB,0CAAiqBF,QAAjqB,4CAA2sBrG,uBAAuB,CAACwG,QAAnuB,qKAAo4BxG,uBAAuB,CAACyG,KAA55B,gFAAs+BH,SAAt+B,eAAo/BC,SAAp/B,0DAA4iCvG,uBAAuB,CAAC0G,YAApkC,yKAA4uCN,WAA5uC,kFAA4zCpG,uBAAuB,CAAC2G,QAAp1C,0DAA24C7F,SAA34C,8DAAq8Cd,uBAAuB,CAAC4G,UAA79C,6GAAskD5G,uBAAuB,CAAC6G,UAA9lD,wHAAmtDP,SAAntD,eAAiuDC,SAAjuD,mEAA+xD/C,MAA/xD,yDAAV,CAxCC,CA0CD;;AACAjE,IAAAA,CAAC,CAACqB,MAAD,CAAD,CAAUb,MAAV,CAAiBmC,IAAjB,EA3CC,CA6CD;;AACA3C,IAAAA,CAAC,CAAC,+BAAD,CAAD,CAAmC0D,IAAnC,CAAwC,UAAUC,KAAV,EAAiB4D,IAAjB,EAAuB;AAC9DvH,MAAAA,CAAC,CAAC,mCAAD,EAAsCA,CAAC,CAACuH,IAAD,CAAvC,CAAD,CAAgDzF,GAAhD,CACC9B,CAAC,CAACuH,IAAD,CAAD,CAAQlF,IAAR,CAAa,0BAAb,CADD;AAGA,KAJD,EA9CC,CAoDD;;AACArC,IAAAA,CAAC,CAAC,yBAAD,CAAD,CAA6BwH,QAA7B,CAAsC,SAAtC;AACA,GAhED;AAkEA;;;;;;;;;AAOA9F,EAAAA,MAAM,CAACtB,SAAP,CAAiBwE,YAAjB,GAAgC,UAAUV,MAAV,EAAkBxB,IAAlB,EAAwB;AACvD;AACAwB,IAAAA,MAAM,CAACrC,IAAP,CAAY,+BAAZ,EAA6CQ,IAA7C,CACC,MADD,EAEC,KAAK+D,cAAL,CAAoB,MAApB,EAA4B;AAC3BnC,MAAAA,MAAM,EAAEvB,IAAI,CAACE;AADc,KAA5B,CAFD,EAFuD,CASvD;;AACAsB,IAAAA,MAAM,CAACrC,IAAP,CAAY,+BAAZ,EAA6CC,GAA7C,CAAiDY,IAAI,CAACE,OAAtD,EAA+D6E,MAA/D,GAVuD,CAYvD;;AACAvD,IAAAA,MAAM,CAACrC,IAAP,CAAY,0BAAZ,EAAwC6F,IAAxC,CAA6C,OAAOhF,IAAI,CAACG,KAAzD;AACA,GAdD;AAgBA;;;;;;;;AAMAnB,EAAAA,MAAM,CAACtB,SAAP,CAAiBuH,YAAjB,GAAgC,UAAUzD,MAAV,EAAkB;AACjD,QAAI0D,OAAO,CAACnH,uBAAuB,CAACoH,YAAzB,CAAX,EAAmD;AAClD3D,MAAAA,MAAM,CAACtD,MAAP;AACA;AACD,GAJD;AAMA;;;;;;;AAKAc,EAAAA,MAAM,CAACtB,SAAP,CAAiBD,YAAjB,GAAgC,YAAY;AAC3C;AACAH,IAAAA,CAAC,CAACa,QAAD,CAAD,CAAYC,EAAZ,CACC,OADD,EAEC,2BAFD,EAGC,UAAUC,CAAV,EAAa;AACZA,MAAAA,CAAC,CAACC,cAAF;AACA,UAAMK,MAAM,GAAGrB,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,IAApB,CAAf;AACA,WAAK2F,YAAL,CAAkBtG,MAAlB;AACA,KAJD,CAIEJ,IAJF,CAIO,IAJP,CAHD,EAF2C,CAY3C;;AACAjB,IAAAA,CAAC,CAACa,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,EAAwB,gCAAxB,EAA0D,UAAUC,CAAV,EAAa;AACtEA,MAAAA,CAAC,CAACC,cAAF;AAEA,UAAMoB,EAAE,GAAGpC,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,GAApB,CAAX;AACAD,MAAAA,aAAa,GAAG/B,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,IAApB,CAAhB;AAEAR,MAAAA,UAAU,CAACC,MAAX,CAAkBQ,QAAlB,CAA2BC,UAA3B,GAAwC,QAAxC;AACAV,MAAAA,UAAU,CAACW,MAAX,CAAkBjC,KAAlB,CAAwBG,IAAxB,CAA6BL,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,GAApB,EAAyBK,IAAzB,CAA8B,MAA9B,CAA7B;AACA,KARD,EAb2C,CAuB3C;;AACArC,IAAAA,CAAC,CAACa,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,EAAwB,8BAAxB,EAAwD,UAAUC,CAAV,EAAa;AACpEA,MAAAA,CAAC,CAACC,cAAF;AAEA,UAAMoB,EAAE,GAAGpC,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,GAApB,CAAX;;AACA,UAAII,EAAE,CAACC,IAAH,CAAQ,MAAR,EAAgBC,OAAhB,CAAwB,UAAxB,IAAsC,CAAC,CAA3C,EAA8C;AAC7Cd,QAAAA,UAAU,CAACC,MAAX,CAAkBQ,QAAlB,CAA2BC,UAA3B,GAAwC,MAAxC;AACA;;AAEDH,MAAAA,aAAa,GAAG/B,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,IAApB,CAAhB;AAEAR,MAAAA,UAAU,CAACW,MAAX,CAAkBjC,KAAlB,CAAwBG,IAAxB,CAA6BL,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,GAApB,EAAyBK,IAAzB,CAA8B,MAA9B,CAA7B;AACA,KAXD;AAYA,GApCD;;AAsCA,SAAO,IAAIX,MAAJ,EAAP;AACA,CAxTc,CAwTZR,MAxTY;;;;;;;;;;;;;ACLf;;AACA;;AACA;;AACA;eACgB,UAAUlB,CAAV,EAAa;AAC5B,MAAI8H,UAAJ;;AAEA,WAASC,WAAT,GAAuB;AACtB/H,IAAAA,CAAC,CACA,YAAY;AACX,UACC,OAAOkF,OAAP,KAAmB,WAAnB,IACAA,OAAO,KAAK,8BAFb,EAGE;AACD,aAAK8C,IAAL;AACA;AACD,KAPD,CAOE/G,IAPF,CAOO,IAPP,CADA,CAAD;AAUA;AAED;;;;;;;AAKA8G,EAAAA,WAAW,CAAC3H,SAAZ,CAAsB4H,IAAtB,GAA6B,YAAY;AACxC,SAAKC,cAAL;AACA,SAAKC,cAAL;AACA,SAAKC,aAAL;AACA,GAJD;;AAMAJ,EAAAA,WAAW,CAAC3H,SAAZ,CAAsB+H,aAAtB,GAAsC,YAAY;AACjDnI,IAAAA,CAAC,CAAC,yBAAD,CAAD,CACEwH,QADF,CACW;AACTY,MAAAA,MAAM,EAAE,6BADC;AAETC,MAAAA,WAAW,EAAE,yBAFJ;AAGTC,MAAAA,WAAW,EAAE,yBAHJ;AAITC,MAAAA,KAJS,iBAIHxH,CAJG,EAIAyH,EAJA,EAII;AACZ,YAAI;AACH,cAAIC,gBAAgB,GAAGvH,MAAM,CAACsH,EAAE,CAACjB,IAAJ,CAAN,CAAgBlF,IAAhB,CACtB,4BADsB,CAAvB;AAGAoG,UAAAA,gBAAgB,GAAG5C,IAAI,CAAC6C,KAAL,CAAWD,gBAAX,CAAnB;;AACA,cAAIA,gBAAgB,IAAI,QAAOA,gBAAP,MAA4B,QAApD,EAA8D;AAC7DvH,YAAAA,MAAM,CAAC,0BAAD,CAAN,CAAmCwC,IAAnC,CAAwC,UACvCC,KADuC,EAEvC0B,OAFuC,EAGtC;AACD,kBACC,CAACoD,gBAAgB,CAACE,QAAjB,CAA0BzH,MAAM,CAAC,IAAD,CAAN,CAAamB,IAAb,CAAkB,cAAlB,CAA1B,CADF,EAEE;AACDnB,gBAAAA,MAAM,CAAC,IAAD,CAAN,CACE0H,MADF,GAEEA,MAFF,GAGEjI,WAHF,CAGc,8BAHd;AAIA,eAPD,MAOO;AACNO,gBAAAA,MAAM,CAAC,IAAD,CAAN,CACE0H,MADF,GAEEA,MAFF,GAGErI,QAHF,CAGW,8BAHX;AAIA;AACD,aAjBD;AAkBA;AACD,SAzBD,CAyBE,OAAOsI,KAAP,EAAc;AACfC,UAAAA,OAAO,CAACC,GAAR,CAAY,6CAA6CF,KAAzD;AACA;AACD,OAjCQ;AAkCTG,MAAAA,IAlCS,gBAkCJjI,CAlCI,EAkCDyH,EAlCC,EAkCG;AACX,YAAMzB,SAAS,GAAGyB,EAAE,CAACjB,IAAH,CAAQjG,OAAR,CAAgB,IAAhB,EAAsBoB,IAAtB,CAA2B,SAA3B,CAAlB;AACA8F,QAAAA,EAAE,CAACjB,IAAH,CACE1F,IADF,CACO,mCADP,EAEE6B,IAFF,CAEO,UAAUC,KAAV,EAAiBC,OAAjB,EAA0B;AAC/B,cAAMqF,OAAO,GAAGjJ,CAAC,CAAC,IAAD,CAAD,CACdqC,IADc,CACT,MADS,EAEd6G,OAFc,CAEN,YAFM,EAEQ,MAAMnC,SAAN,GAAkB,GAF1B,CAAhB;AAGA/G,UAAAA,CAAC,CAAC,IAAD,CAAD,CAAQqC,IAAR,CAAa,MAAb,EAAqB4G,OAArB;AACA,SAPF;AAQA/H,QAAAA,MAAM,CAAC,sBAAD,CAAN,CAA+BP,WAA/B,CACC,8BADD;AAGA;AA/CQ,KADX,EAkDEM,IAlDF,CAkDO,IAlDP;AAmDA,GApDD;AAsDA;;;;;;;AAKA8G,EAAAA,WAAW,CAAC3H,SAAZ,CAAsB6H,cAAtB,GAAuC,YAAY;AAClDjI,IAAAA,CAAC,CAAC,0BAAD,CAAD,CAA8BmJ,SAA9B,CAAwC;AACvCC,MAAAA,QAAQ,EAAE,MAD6B;AAEvCC,MAAAA,WAAW,EAAE,UAF0B;AAGvCC,MAAAA,MAAM,EAAE,KAH+B;AAIvCC,MAAAA,MAAM,EAAE,OAJ+B;AAKvCC,MAAAA,MAAM,EAAE,SAL+B;AAMvCC,MAAAA,cAAc,EAAE,GANuB;AAOvClB,MAAAA,KAPuC,iBAOjCmB,KAPiC,EAO1BlB,EAP0B,EAOtB;AAChB,YAAI;AACH,cAAIC,gBAAgB,GAAGvH,MAAM,CAAC,IAAD,CAAN,CAAamB,IAAb,CACtB,4BADsB,CAAvB;AAGAoG,UAAAA,gBAAgB,GAAG5C,IAAI,CAAC6C,KAAL,CAAWD,gBAAX,CAAnB;;AAEA,cAAIA,gBAAgB,IAAI,QAAOA,gBAAP,MAA4B,QAApD,EAA8D;AAC7DvH,YAAAA,MAAM,CAAC,0BAAD,CAAN,CAAmCwC,IAAnC,CAAwC,UAAUC,KAAV,EAAiB0B,OAAjB,EAA0B;AACjE,kBACC,CAACoD,gBAAgB,CAACE,QAAjB,CAA0BzH,MAAM,CAAC,IAAD,CAAN,CAAamB,IAAb,CAAkB,cAAlB,CAA1B,CADF,EAEE;AACDnB,gBAAAA,MAAM,CAAC,IAAD,CAAN,CACE0H,MADF,GAEEA,MAFF,GAGEjI,WAHF,CAGc,8BAHd;AAIA,eAPD,MAOO;AACNO,gBAAAA,MAAM,CAAC,IAAD,CAAN,CACE0H,MADF,GAEEA,MAFF,GAGErI,QAHF,CAGW,8BAHX;AAIA;AACD,aAdD;AAeA;AACD,SAvBD,CAuBE,OAAOsI,KAAP,EAAc;AACfC,UAAAA,OAAO,CAACC,GAAR,CAAY,6CAA6CF,KAAzD;AACA;AACD,OAlCsC;AAmCvCG,MAAAA,IAnCuC,gBAmClCU,KAnCkC,EAmC3BlB,EAnC2B,EAmCvB;AACftH,QAAAA,MAAM,CAAC,sBAAD,CAAN,CAA+BP,WAA/B,CACC,8BADD;AAGA;AAvCsC,KAAxC;AAyCA,GA1CD;AA4CA;;;;;;;AAKAoH,EAAAA,WAAW,CAAC3H,SAAZ,CAAsB8H,cAAtB,GAAuC,YAAY;AAClDlI,IAAAA,CAAC,CAAC,0BAAD,CAAD,CACE2J,SADF,CACY;AACVC,MAAAA,MAAM,EAAE,0BADE;AAEVC,MAAAA,UAAU,EAAE,4BAFF;AAGVC,MAAAA,IAAI,EAAE,UAAU/I,CAAV,EAAayH,EAAb,EAAiB;AACtB,aAAKuB,YAAL,CAAkBhJ,CAAlB,EAAqByH,EAArB;AACA,OAFK,CAEJvH,IAFI,CAEC,IAFD;AAHI,KADZ,EAQEA,IARF,CAQO,IARP;AASA,GAVD;AAYA;;;;;;;;;AAOA8G,EAAAA,WAAW,CAAC3H,SAAZ,CAAsB2J,YAAtB,GAAqC,UAAUhJ,CAAV,EAAayH,EAAb,EAAiB;AACrD,QAAMtE,MAAM,GAAGsE,EAAE,CAACW,SAAlB;AACA,QAAMzC,UAAU,GAAGxC,MAAM,CAACrC,IAAP,CAAY,yBAAZ,EAAuC6F,IAAvC,EAAnB;AACA,QAAMjB,QAAQ,GAAGvC,MAAM,CAACxB,IAAP,CAAY,WAAZ,CAAjB;AACA,QAAMgD,aAAa,GAAGxB,MAAM,CAAC7B,IAAP,CAAY,4BAAZ,CAAtB;AAEAb,IAAAA,UAAU,CAACC,MAAX,CAAkBC,MAAlB,CAAyBqE,SAAzB,CACChF,CAAC,CAACM,MADH,EAECoF,QAFD,EAGCC,UAHD,EAICsD,SAJD,EAKCA,SALD,EAMCA,SAND,EAOCA,SAPD,EAQCA,SARD,EASCtE,aATD;AAWA,GAjBD;;AAmBA,SAAO,IAAIqC,WAAJ,EAAP;AACA,CA9Kc,CA8KZ7G,MA9KY;;;;;;;;;;;ACJf;;AACA;;AACA;eACgB,UAAUlB,CAAV,EAAa;AAC5B,WAAS6E,QAAT,GAAoB;AACnB7E,IAAAA,CAAC,CAAC,YAAY,CACb;AACA,KAFA,CAAD;AAGA;;AAED6E,EAAAA,QAAQ,CAACzE,SAAT,CAAmB0E,IAAnB,GAA0B,UAAUmF,QAAV,EAAoB;AAC7CjK,IAAAA,CAAC,CAAC,iDAAD,CAAD,CAAqD+D,GAArD,CACC,YADD,EAEC,SAFD;AAIA,QAAMK,OAAO,GAAGpE,CAAC,CAACiK,QAAD,CAAD,CAAYC,eAAZ,EAAhB;AACA9F,IAAAA,OAAO,CAACE,EAAR,GAAac,kBAAb;AACAhB,IAAAA,OAAO,CAACC,MAAR,GAAiB,cAAjB;AAEArE,IAAAA,CAAC,CAACuE,IAAF,CAAOC,OAAP,EAAgBJ,OAAhB,EAAyB,YAAY;AACpCpE,MAAAA,CAAC,CAAC,iDAAD,CAAD,CAAqD+D,GAArD,CACC,YADD,EAEC,QAFD;AAIA,KALD;AAMA,GAfD;;AAiBA,SAAO,IAAIc,QAAJ,EAAP;AACA,CAzBc,CAyBZ3D,MAzBY;;;;;;ACCf;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAXA;;AACA;;AACA;;AACA;AAUA,IAAIM,UAAU,GAAGA,UAAU,IAAI,EAA/B;AACAA,UAAU,CAACW,MAAX,GAAoB;AAACjC,EAAAA,KAAK,EAALA;AAAD,CAApB;AACAsB,UAAU,CAACsB,OAAX,GAAqBA,gBAArB;AACAtB,UAAU,CAACsB,OAAX,CAAmB1B,MAAnB,GAA4BA,eAA5B;AACAI,UAAU,CAACC,MAAX,GAAoB;AAAC6B,EAAAA,QAAQ,EAARA,iBAAD;AAAWrB,EAAAA,QAAQ,EAARA,iBAAX;AAAqBP,EAAAA,MAAM,EAANA,eAArB;AAA6BqG,EAAAA,WAAW,EAAXA,oBAA7B;AAA0ClD,EAAAA,QAAQ,EAARA;AAA1C,CAApB;;AAEA,CAAC,UAAU7E,CAAV,EAAa;AACbA,EAAAA,CAAC,CAAC,+CAAD,CAAD,CAAmDc,EAAnD,CAAsD,OAAtD,EAA+D,UAAUC,CAAV,EAAa;AAC3E,QAAMoJ,SAAS,GAAGnK,CAAC,CAAC,IAAD,CAAD,CAAQoK,EAAR,CAAW,UAAX,CAAlB;AACA,QAAMC,KAAK,GAAGrK,CAAC,CAAC,IAAD,CAAD,CAAQqC,IAAR,CAAa,OAAb,CAAd;AACAiI,IAAAA,KAAK,CAAC,CAAD,CAAL;;AACA,QAAIvJ,CAAC,CAACwJ,QAAN,EAAgB;AACf,UAAI,CAACJ,SAAL,EAAgB;AACfnK,QAAAA,CAAC,CACA,0DAA0DqK,KAA1D,GAAkE,IADlE,CAAD,CAEEhI,IAFF,CAEO,SAFP,EAEkB,KAFlB;AAGA,OAJD,MAIO;AACNrC,QAAAA,CAAC,CACA,0DAA0DqK,KAA1D,GAAkE,IADlE,CAAD,CAEEhI,IAFF,CAEO,SAFP,EAEkB,IAFlB;AAGA;AACD;AACD,GAfD;AAgBA,CAjBD,EAiBGnB,MAjBH;;AAmBA,CAAC,UAAUlB,CAAV,EAAa;AACb;AACAA,EAAAA,CAAC,CAAC,8BAAD,CAAD,CAAkCc,EAAlC,CAAqC,OAArC,EAA8C,YAAY;AACzDd,IAAAA,CAAC,CAAC,IAAD,CAAD,CAAQwK,QAAR,CAAiB,UAAjB,EAA6BzG,GAA7B,CAAiC,YAAjC,EAA+C,SAA/C;AACA,GAFD,EAFa,CAMb;;AACA/D,EAAAA,CAAC,CAAC,mDAAD,CAAD,CAAuD4I,MAAvD,CAA8D,IAA9D,EAAoEhI,MAApE,GAPa,CASb;;AACAZ,EAAAA,CAAC,CAAC,oBAAD,CAAD,CAAwBc,EAAxB,CAA2B,OAA3B,EAAoC,YAAY;AAC/C,QAAI2J,EAAE,CAACC,QAAP,EAAiB;AAChB1K,MAAAA,CAAC,CAAC2K,MAAD,CAAD,CAAUC,MAAV;AAEAH,MAAAA,EAAE,CAACC,QAAH,CAAYG,MAAZ,CAAmBC,WAAnB;AAEA9K,MAAAA,CAAC,CAACa,QAAD,CAAD,CAAYkK,YAAZ,CAAyB,YAAY;AACpC,eAAO,IAAP;AACA,OAFD;AAGA;;AAED,WAAO,IAAP;AACA,GAZD;AAaA,CAvBD,EAuBG7J,MAvBH;AAyBA;;;AACAA,MAAM,CAACL,QAAD,CAAN,CAAiBmK,KAAjB,CAAuB,UAAUhL,CAAV,EAAa;AACnC,MAAIA,CAAC,CAAC,wBAAD,CAAD,CAA4B6D,MAAhC,EAAwC;AACvC,QAAMoH,MAAM,GAAGjL,CAAC,CAAC,wBAAD,CAAD,CAA4BiL,MAA5B,EAAf;AACAjL,IAAAA,CAAC,CAACa,QAAD,CAAD,CAAYyI,MAAZ,CAAmB,YAAY;AAC9B,UACCtJ,CAAC,CAAC2K,MAAD,CAAD,CAAUO,SAAV,KAAwB,EAAxB,GAA6BD,MAAM,CAACE,GAApC,IACA,CAACnL,CAAC,CAAC,wBAAD,CAAD,CAA4BoL,QAA5B,CAAqC,UAArC,CAFF,EAGE;AACDpL,QAAAA,CAAC,CAAC,wBAAD,CAAD,CAA4BO,QAA5B,CAAqC,UAArC;AACA,OALD,MAKO,IACNP,CAAC,CAAC2K,MAAD,CAAD,CAAUO,SAAV,KAAwB,EAAxB,GAA6BD,MAAM,CAACE,GAApC,IACAnL,CAAC,CAAC,wBAAD,CAAD,CAA4BoL,QAA5B,CAAqC,UAArC,CAFM,EAGL;AACDpL,QAAAA,CAAC,CAAC,wBAAD,CAAD,CAA4BW,WAA5B,CAAwC,UAAxC;AACA;AACD,KAZD;AAaA;;AAEDX,EAAAA,CAAC,CAAC,2BAAD,CAAD,CAA+Bc,EAA/B,CAAkC,OAAlC,EAA2C,UAAUC,CAAV,EAAa;AACvDA,IAAAA,CAAC,CAACC,cAAF;AAEAQ,IAAAA,UAAU,CAACC,MAAX,CAAkBQ,QAAlB,CAA2BC,UAA3B,GAAwC,uBAAxC;AACAV,IAAAA,UAAU,CAACW,MAAX,CAAkBjC,KAAlB,CAAwBG,IAAxB,CAA6BL,CAAC,CAACe,CAAC,CAACM,MAAH,CAAD,CAAYW,OAAZ,CAAoB,GAApB,EAAyBK,IAAzB,CAA8B,MAA9B,CAA7B;AACA,GALD;AAMA,CAxBD;AA0BA;;AACAnB,MAAM,CAACL,QAAD,CAAN,CAAiBmK,KAAjB,CAAuB,UAAUhL,CAAV,EAAa;AACnCA,EAAAA,CAAC,CAAC,kBAAD,CAAD,CAAsBqL,IAAtB;;AAEA,MACCrL,CAAC,CAAC,qCAAD,CAAD,CAAyC8B,GAAzC,OAAmD,MAAnD,IACA9B,CAAC,CAAC,qCAAD,CAAD,CAAyC8B,GAAzC,OAAmD,MAFpD,EAGE;AACD9B,IAAAA,CAAC,CAAC,kBAAD,CAAD,CAAsBsL,IAAtB;AACA;;AACDtL,EAAAA,CAAC,CAAC,MAAD,CAAD,CACEc,EADF,CACK,QADL,EACe,qCADf,EACsD,YAAY;AAChE,QACCd,CAAC,CAAC,qCAAD,CAAD,CAAyC8B,GAAzC,OAAmD,MAAnD,IACA9B,CAAC,CAAC,qCAAD,CAAD,CAAyC8B,GAAzC,OAAmD,MAFpD,EAGE;AACD9B,MAAAA,CAAC,CAAC,kBAAD,CAAD,CAAsBsL,IAAtB;AACA,KALD,MAKO;AACNtL,MAAAA,CAAC,CAAC,kBAAD,CAAD,CAAsBqL,IAAtB;AACA;AACD,GAVF,EAWEE,OAXF,CAWU,QAXV;AAYA,CArBD","file":"modularity.dev.js","sourceRoot":"..\\..\\source\\js","sourcesContent":["/* eslint-disable no-implicit-globals */\r\n/* eslint-disable no-unused-vars */\r\n/* eslint-disable no-undef */\r\nexport default (function ($) {\r\n\tlet isOpen = false;\r\n\r\n\tfunction Modal() {\r\n\t\tthis.handleEvents();\r\n\t}\r\n\r\n\tModal.prototype.open = function (url) {\r\n\t\t$('body').addClass('modularity-modal-open').append(\r\n\t\t\t`\r\n            <div id=\"modularity-modal\">\r\n                <div class=\"modularity-modal-wrapper\">\r\n                    <button class=\"modularity-modal-close\" data-modularity-modal-action=\"close\">&times;\r\n\t\t\t\t\t            ${modularityAdminLanguage.close}\r\n\t\t\t\t\t          </button>\r\n                    <div class=\"modularity-modal-spinner-container\" id=\"modularity-iframe-loader\"><span class=\"modularity-modal-spinner\"></span></div>\r\n                    <iframe class=\"modularity-modal-iframe\" src=\"${url}\" frameborder=\"0\" onload=\"document.getElementById('modularity-iframe-loader').style.display='none';\" allowtransparency></iframe>\r\n                </div>\r\n            </div>\r\n        `\r\n\t\t);\r\n\r\n\t\tisOpen = true;\r\n\t};\r\n\r\n\tModal.prototype.close = function () {\r\n\t\t$('body').removeClass('modularity-modal-open');\r\n\t\t$('#modularity-modal').remove();\r\n\t\tisOpen = false;\r\n\t};\r\n\r\n\tModal.prototype.handleEvents = function () {\r\n\t\t$(document).on(\r\n\t\t\t'click',\r\n\t\t\t'[data-modularity-modal-action=\"close\"]',\r\n\t\t\tfunction (e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tthis.close();\r\n\t\t\t}.bind(this)\r\n\t\t);\r\n\t};\r\n\r\n\treturn new Modal();\r\n})(jQuery);\r\n","/* eslint-disable no-implicit-globals */\r\n/* eslint-disable no-undef */\r\nexport default (function ($) {\r\n\tlet editingWidget = false;\r\n\r\n\tfunction Widget() {\r\n\t\t$(function () {\r\n\t\t\t/* Import */\r\n\t\t\t$(document).on(\r\n\t\t\t\t'click',\r\n\t\t\t\t'.modularity-js-thickbox-widget-import-widget',\r\n\t\t\t\tfunction (e) {\r\n\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\teditingWidget = $(e.target).parents('.widget-inside');\r\n\r\n\t\t\t\t\tconst importUrl = Modularity.Editor.Module.getImportUrl({\r\n\t\t\t\t\t\tpostType: $(e.target)\r\n\t\t\t\t\t\t\t.parents('.widget-inside')\r\n\t\t\t\t\t\t\t.find('.modularity-widget-module-type select')\r\n\t\t\t\t\t\t\t.val(),\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tModularity.Editor.Module.editingModule = $(e.target).closest(\r\n\t\t\t\t\t\t'.widget-inside'\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tModularity.Editor.Thickbox.postAction = 'import-widget';\r\n\t\t\t\t\tModularity.Prompt.Modal.open(importUrl);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\t/* Edit */\r\n\t\t\t$(document).on('click', '.modularity-js-thickbox-open-widget', function (\r\n\t\t\t\te\r\n\t\t\t) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tconst el = $(e.target).closest('a');\r\n\t\t\t\tif (el.attr('href').indexOf('post.php') > -1) {\r\n\t\t\t\t\tModularity.Editor.Thickbox.postAction = 'edit';\r\n\t\t\t\t}\r\n\r\n\t\t\t\teditingModule = $(e.target).closest('li');\r\n\r\n\t\t\t\tModularity.Prompt.Modal.open($(e.target).closest('a').attr('href'));\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tWidget.prototype.isEditingWidget = function () {\r\n\t\treturn editingWidget;\r\n\t};\r\n\r\n\tWidget.prototype.updateWidget = function (widget, data) {\r\n\t\t$(widget).find('.modularity-widget-module-id-span').html(data.post_id);\r\n\t\t$(widget).find('.modularity-widget-module-id').val(data.post_id);\r\n\t\t$(widget)\r\n\t\t\t.find('.modularity-widget-module-edit')\r\n\t\t\t.attr(\r\n\t\t\t\t'href',\r\n\t\t\t\t'post.php?post=' + data.post_id + '&action=edit&is_thickbox=true'\r\n\t\t\t)\r\n\t\t\t.removeClass('hidden');\r\n\t\t$(widget).find('.modularity-widget-module-title-span').html(data.title);\r\n\t\t$(widget).find('.modularity-widget-module-title').val(data.title);\r\n\t};\r\n\r\n\treturn new Widget();\r\n})(jQuery);\r\n","/* eslint-disable no-empty-function */\r\n/* eslint-disable no-extra-bind */\r\n/* eslint-disable no-undef */\r\n/* eslint-disable no-implicit-globals */\r\nexport default (function ($) {\r\n\tfunction Helpers() {\r\n\t\t$(function () {}.bind(this));\r\n\t}\r\n\r\n\tHelpers.prototype.uuid = function () {\r\n\t\treturn Math.random().toString(36).substr(2, 9);\r\n\t};\r\n\r\n\treturn new Helpers();\r\n})(jQuery);\r\n","export default (function ($) {\r\n\tlet hasErrors = false;\r\n\tconst errorClass = 'validation-error';\r\n\r\n\tfunction Validate() {\r\n\t\tthis.handleEvents();\r\n\t}\r\n\r\n\t/**\r\n\t * Run validation methods\r\n\t *\r\n\t * @return {void}\r\n\t */\r\n\tValidate.prototype.run = function () {\r\n\t\thasErrors = false;\r\n\t\tthis.checkRequired();\r\n\t};\r\n\r\n\t/**\r\n\t * Check required fileds is not empty\r\n\t *\r\n\t * @return {void}\r\n\t */\r\n\tValidate.prototype.checkRequired = function () {\r\n\t\tconst required = $('[required]');\r\n\t\trequired.removeClass(errorClass);\r\n\r\n\t\trequired.each(function (index, element) {\r\n\t\t\tif ($(element).val().length === 0) {\r\n\t\t\t\t$(element).parents('li').addClass(errorClass);\r\n\r\n\t\t\t\t$(element).one('change', function (e) {\r\n\t\t\t\t\t$(e.target).parents('li').removeClass(errorClass);\r\n\t\t\t\t});\r\n\r\n\t\t\t\thasErrors = true;\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t * Handle events\r\n\t *\r\n\t * @return {void}\r\n\t */\r\n\tValidate.prototype.handleEvents = function () {\r\n\t\t$(document).on(\r\n\t\t\t'click',\r\n\t\t\t'#modularity-mb-editor-publish #publish',\r\n\t\t\tfunction () {\r\n\t\t\t\tthis.run();\r\n\r\n\t\t\t\tif (hasErrors) {\r\n\t\t\t\t\t$('#modularity-mb-editor-publish .spinner').css(\r\n\t\t\t\t\t\t'visibility',\r\n\t\t\t\t\t\t'hidden'\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}.bind(this)\r\n\t\t);\r\n\t};\r\n\r\n\treturn new Validate();\r\n})(jQuery);\r\n","export default (function ($) {\r\n\t/**\r\n\t * Attention: This variable should not be set manually\r\n\t *\r\n\t * Indicates if we are adding a new post or editing old one\r\n\t *\r\n\t * @type {string}\r\n\t */\r\n\tconst postAction = 'add';\r\n\r\n\tfunction Thickbox() {}\r\n\r\n\tThickbox.prototype.modulePostCreated = function (postId) {\r\n\t\tModularity.Prompt.Modal.close();\r\n\r\n\t\tconst module = Modularity.Editor.Module.isEditingModule();\r\n\r\n\t\tconst request = {\r\n\t\t\taction: 'get_post',\r\n\t\t\tid: postId,\r\n\t\t};\r\n\r\n\t\t$.post(\r\n\t\t\tajaxurl,\r\n\t\t\trequest,\r\n\t\t\tfunction (response) {\r\n\t\t\t\tconst data = {\r\n\t\t\t\t\tpost_id: response.ID,\r\n\t\t\t\t\ttitle: response.post_title,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tModularity.Editor.Module.updateModule(module, data);\r\n\t\t\t\tModularity.Editor.Autosave.save('form');\r\n\t\t\t},\r\n\t\t\t'json'\r\n\t\t);\r\n\t};\r\n\r\n\treturn new Thickbox();\r\n})(jQuery);\r\n","/* eslint-disable no-alert */\r\n/* eslint-disable camelcase */\r\n/* eslint-disable no-unused-vars */\r\n/* eslint-disable no-implicit-globals */\r\n/* eslint-disable no-undef */\r\nexport default (function ($) {\r\n\tconst initCompleted = false;\r\n\r\n\t/**\r\n\t * Object to create Thickbox querystring from\r\n\t *\r\n\t * @type {Object}\r\n\t */\r\n\tconst thickboxOptions = {\r\n\t\tis_thickbox: true,\r\n\t};\r\n\r\n\tlet editingModule = false;\r\n\r\n\tfunction Module() {\r\n\t\t$(\r\n\t\t\tfunction () {\r\n\t\t\t\tif (\r\n\t\t\t\t\ttypeof pagenow !== 'undefined' &&\r\n\t\t\t\t\tpagenow === 'admin_page_modularity-editor'\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.handleEvents();\r\n\t\t\t\t\tthis.loadModules(modularity_post_id);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this)\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Loads saved modules and adds them to the page\r\n\t *\r\n\t * @param  {number} postId The post id to load modules from\r\n\t * @return {void}\r\n\t */\r\n\tModule.prototype.loadModules = function (postId) {\r\n\t\tconst request = {\r\n\t\t\taction: 'get_post_modules',\r\n\t\t\tid: postId,\r\n\t\t};\r\n\r\n\t\t$.post(\r\n\t\t\tajaxurl,\r\n\t\t\trequest,\r\n\t\t\tfunction (response) {\r\n\t\t\t\t$.each(\r\n\t\t\t\t\tresponse,\r\n\t\t\t\t\tfunction (sidebar, modules) {\r\n\t\t\t\t\t\tconst sidebarElement = $(\r\n\t\t\t\t\t\t\t'.modularity-sidebar-area[data-area-id=\"' + sidebar + '\"]'\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t$.each(\r\n\t\t\t\t\t\t\tmodules.modules,\r\n\t\t\t\t\t\t\tfunction (key, data) {\r\n\t\t\t\t\t\t\t\tif (data.hidden === 'true') {\r\n\t\t\t\t\t\t\t\t\tdata.hidden = true;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tconst incompability =\r\n\t\t\t\t\t\t\t\t\ttypeof data.sidebar_incompability !== 'undefined' &&\r\n\t\t\t\t\t\t\t\t\t!$.isEmptyObject(data.sidebar_incompability)\r\n\t\t\t\t\t\t\t\t\t\t? JSON.stringify(data.sidebar_incompability)\r\n\t\t\t\t\t\t\t\t\t\t: '';\r\n\t\t\t\t\t\t\t\tthis.addModule(\r\n\t\t\t\t\t\t\t\t\tsidebarElement,\r\n\t\t\t\t\t\t\t\t\tdata.post_type,\r\n\t\t\t\t\t\t\t\t\tdata.post_type_name,\r\n\t\t\t\t\t\t\t\t\tdata.post_title,\r\n\t\t\t\t\t\t\t\t\tdata.ID,\r\n\t\t\t\t\t\t\t\t\tdata.hidden,\r\n\t\t\t\t\t\t\t\t\tdata.columnWidth,\r\n\t\t\t\t\t\t\t\t\tdata.isDeprecated,\r\n\t\t\t\t\t\t\t\t\tincompability\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tsidebarElement.removeClass('modularity-spinner');\r\n\t\t\t\t\t}.bind(this)\r\n\t\t\t\t);\r\n\r\n\t\t\t\tthis.initCompleted = true;\r\n\t\t\t\t$('.modularity-sidebar-area').removeClass('modularity-spinner');\r\n\t\t\t}.bind(this),\r\n\t\t\t'json'\r\n\t\t);\r\n\t};\r\n\r\n\t/**\r\n\t * Check editing module\r\n\t *\r\n\t * @return {boolean|string} Returns boolean or string\r\n\t */\r\n\tModule.prototype.isEditingModule = function () {\r\n\t\treturn editingModule;\r\n\t};\r\n\r\n\t/**\r\n\t * Generates a thickbox url to open a thickbox in correct mode\r\n\t *\r\n\t * @param  {string} action Should be \"add\" or \"edit\"\r\n\t * @param  {Object} data   Should contain additional data (for now supports \"postId\" and \"postType\")\r\n\t * @return {string}        Thickbox url\r\n\t */\r\n\tModule.prototype.getThickBoxUrl = function (action, data) {\r\n\t\tlet base = '';\r\n\t\tconst querystring = {};\r\n\r\n\t\tswitch (action) {\r\n\t\t\tcase 'add':\r\n\t\t\t\tbase = 'post-new.php';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'edit':\r\n\t\t\t\tbase = 'post.php';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (typeof data.postId === 'number') {\r\n\t\t\tquerystring.post = data.postId;\r\n\t\t\tquerystring.action = 'edit';\r\n\t\t}\r\n\r\n\t\tif (typeof data.postType === 'string') {\r\n\t\t\tquerystring.post_type = data.postType;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\tadmin_url +\r\n\t\t\tbase +\r\n\t\t\t'?' +\r\n\t\t\t$.param(querystring) +\r\n\t\t\t'&' +\r\n\t\t\t$.param(thickboxOptions)\r\n\t\t);\r\n\t};\r\n\r\n\tModule.prototype.getImportUrl = function (data) {\r\n\t\tconst base = 'edit.php';\r\n\t\tconst querystring = {};\r\n\r\n\t\tquerystring.post_type = data.postType;\r\n\r\n\t\treturn (\r\n\t\t\tadmin_url +\r\n\t\t\tbase +\r\n\t\t\t'?' +\r\n\t\t\t$.param(querystring) +\r\n\t\t\t'&' +\r\n\t\t\t$.param(thickboxOptions)\r\n\t\t);\r\n\t};\r\n\r\n\t/**\r\n\t * Adds a module \"row\" to the target placeholder\r\n\t *\r\n\t * @param {Object} target   The target selector\r\n\t * @param {string} moduleId   The module id slug\r\n\t * @param {string} moduleName The module name\r\n\t * @param {string} moduleTitle Title\r\n\t * @param {number} postId Id\r\n\t * @param {boolean} hidden Is Hidden\r\n\t * @param {number} columnWidth Column Width\r\n\t * @param {boolean} isDeprecated Is Deprecated\r\n\t * @param {boolean} incompability Is Incompatible?\r\n\t * @return {void}\r\n\t */\r\n\tModule.prototype.addModule = function (\r\n\t\ttarget,\r\n\t\tmoduleId,\r\n\t\tmoduleName,\r\n\t\tmoduleTitle,\r\n\t\tpostId,\r\n\t\thidden,\r\n\t\tcolumnWidth,\r\n\t\tisDeprecated,\r\n\t\tincompability\r\n\t) {\r\n\t\tmoduleTitle = typeof moduleTitle !== 'undefined' ? ': ' + moduleTitle : '';\r\n\t\tpostId = typeof postId !== 'undefined' ? postId : '';\r\n\t\tcolumnWidth = typeof columnWidth !== 'undefined' ? columnWidth : '';\r\n\t\tdeprecated =\r\n\t\t\tisDeprecated === true\r\n\t\t\t\t? `<span class=\"modularity-deprecated\" style=\"color:#ff0000;\">(${modularityAdminLanguage.deprecated})</span>`\r\n\t\t\t\t: '';\r\n\t\tincompability = typeof incompability !== 'undefined' ? incompability : '';\r\n\r\n\t\t// Get thickbox url\r\n\t\tlet thickboxUrl = this.getThickBoxUrl('add', {\r\n\t\t\tpostType: moduleId,\r\n\t\t});\r\n\r\n\t\t// Set thickbox action\r\n\t\tModularity.Editor.Thickbox.postAction = 'add';\r\n\r\n\t\tif (postId) {\r\n\t\t\tthickboxUrl = this.getThickBoxUrl('edit', {\r\n\t\t\t\tpostId,\r\n\t\t\t});\r\n\r\n\t\t\tModularity.Editor.Thickbox.postAction = 'edit';\r\n\t\t}\r\n\r\n\t\t// Get import url\r\n\t\tconst importUrl = this.getImportUrl({\r\n\t\t\tpostType: moduleId,\r\n\t\t});\r\n\r\n\t\t// Check/uncheck hidden checkbox\r\n\t\tlet isHidden = '';\r\n\t\tif (hidden === true) {\r\n\t\t\tisHidden = 'checked';\r\n\t\t}\r\n\r\n\t\tconst sidebarId = $(target).data('area-id');\r\n\t\tconst itemRowId = Modularity.Helpers.uuid();\r\n\r\n\t\tconst html = `<li id=\"post-${postId}\" data-module-id=\"${moduleId}\" data-module-stored-width=\"${columnWidth}\" data-sidebar-incompability='${incompability}'>                <span class=\"modularity-line-wrapper\">                    <span class=\"modularity-sortable-handle\"></span>                    <span class=\"modularity-module-name\">                        ${moduleName}                        ${deprecated}                        <span class=\"modularity-module-title\">${moduleTitle}</span>                        <label class=\"modularity-module-hide\">                            <input type=\"checkbox\" name=\"modularity_modules[${sidebarId}][${itemRowId}][hidden]\" value=\"hidden\" ${isHidden} />                            ${modularityAdminLanguage.langhide}                        </label>                    </span>                    <span class=\"modularity-module-columns\">                        <label>${modularityAdminLanguage.width}:</label>                        <select name=\"modularity_modules[${sidebarId}][${itemRowId}][columnWidth]\">                            ${modularityAdminLanguage.widthOptions}                        </select>                    </span>                    <span class=\"modularity-module-actions\">                        <a href=\"${thickboxUrl}\" data-modularity-modal class=\"modularity-js-thickbox-open\"><span>${modularityAdminLanguage.langedit}</span></a>                        <a href=\"${importUrl}\" class=\"modularity-js-thickbox-import\"><span>${modularityAdminLanguage.langimport}</span></a>                        <a href=\"#remove\" class=\"modularity-module-remove\"><span>${modularityAdminLanguage.langremove}</span></a>                    </span>                    <input type=\"hidden\" name=\"modularity_modules[${sidebarId}][${itemRowId}][postid]\" class=\"modularity-js-module-id\" value=\"${postId}\" required>                </span>            </li>`;\r\n\r\n\t\t// Store\r\n\t\t$(target).append(html);\r\n\r\n\t\t// Update width selector\r\n\t\t$('.modularity-sidebar-area > li').each(function (index, item) {\r\n\t\t\t$('.modularity-module-columns select', $(item)).val(\r\n\t\t\t\t$(item).attr('data-module-stored-width')\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\t// Refresh\r\n\t\t$('.modularity-js-sortable').sortable('refresh');\r\n\t};\r\n\r\n\t/**\r\n\t * Updates a module \"row\" after editing the module post\r\n\t *\r\n\t * @param  {HTMLElement} module    Module dom element\r\n\t * @param  {Object} data   The data\r\n\t * @return {void}\r\n\t */\r\n\tModule.prototype.updateModule = function (module, data) {\r\n\t\t// Href\r\n\t\tmodule.find('a.modularity-js-thickbox-open').attr(\r\n\t\t\t'href',\r\n\t\t\tthis.getThickBoxUrl('edit', {\r\n\t\t\t\tpostId: data.post_id,\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\t// Post id input\r\n\t\tmodule.find('input.modularity-js-module-id').val(data.post_id).change();\r\n\r\n\t\t// Post title\r\n\t\tmodule.find('.modularity-module-title').text(': ' + data.title);\r\n\t};\r\n\r\n\t/**\r\n\t * Removes a module \"row\" from the placeholder\r\n\t *\r\n\t * @param  {HTMLElement} module The (to be removed) module's dom element\r\n\t * @return {void}\r\n\t */\r\n\tModule.prototype.removeModule = function (module) {\r\n\t\tif (confirm(modularityAdminLanguage.actionRemove)) {\r\n\t\t\tmodule.remove();\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * Handle events\r\n\t *\r\n\t * @return {void}\r\n\t */\r\n\tModule.prototype.handleEvents = function () {\r\n\t\t// Trash icon\r\n\t\t$(document).on(\r\n\t\t\t'click',\r\n\t\t\t'.modularity-module-remove',\r\n\t\t\tfunction (e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tconst target = $(e.target).closest('li');\r\n\t\t\t\tthis.removeModule(target);\r\n\t\t\t}.bind(this)\r\n\t\t);\r\n\r\n\t\t// Import\r\n\t\t$(document).on('click', '.modularity-js-thickbox-import', function (e) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst el = $(e.target).closest('a');\r\n\t\t\teditingModule = $(e.target).closest('li');\r\n\r\n\t\t\tModularity.Editor.Thickbox.postAction = 'import';\r\n\t\t\tModularity.Prompt.Modal.open($(e.target).closest('a').attr('href'));\r\n\t\t});\r\n\r\n\t\t// Edit\r\n\t\t$(document).on('click', '.modularity-js-thickbox-open', function (e) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tconst el = $(e.target).closest('a');\r\n\t\t\tif (el.attr('href').indexOf('post.php') > -1) {\r\n\t\t\t\tModularity.Editor.Thickbox.postAction = 'edit';\r\n\t\t\t}\r\n\r\n\t\t\teditingModule = $(e.target).closest('li');\r\n\r\n\t\t\tModularity.Prompt.Modal.open($(e.target).closest('a').attr('href'));\r\n\t\t});\r\n\t};\r\n\r\n\treturn new Module();\r\n})(jQuery);\r\n","/* eslint-disable no-console */\r\n/* eslint-disable no-unused-vars */\r\n/* eslint-disable no-implicit-globals */\r\n/* eslint-disable no-undef */\r\nexport default (function ($) {\r\n\tlet sortableIn;\r\n\r\n\tfunction DragAndDrop() {\r\n\t\t$(\r\n\t\t\tfunction () {\r\n\t\t\t\tif (\r\n\t\t\t\t\ttypeof pagenow !== 'undefined' &&\r\n\t\t\t\t\tpagenow === 'admin_page_modularity-editor'\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.init();\r\n\t\t\t\t}\r\n\t\t\t}.bind(this)\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Initialize\r\n\t *\r\n\t * @return {void}\r\n\t */\r\n\tDragAndDrop.prototype.init = function () {\r\n\t\tthis.setupDraggable();\r\n\t\tthis.setupDroppable();\r\n\t\tthis.setupSortable();\r\n\t};\r\n\r\n\tDragAndDrop.prototype.setupSortable = function () {\r\n\t\t$('.modularity-js-sortable')\r\n\t\t\t.sortable({\r\n\t\t\t\thandle: '.modularity-sortable-handle',\r\n\t\t\t\tconnectWith: '.modularity-js-sortable',\r\n\t\t\t\tplaceholder: 'ui-sortable-placeholder',\r\n\t\t\t\tstart(e, ui) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlet validTargetAreas = jQuery(ui.item).attr(\r\n\t\t\t\t\t\t\t'data-sidebar-incompability'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tvalidTargetAreas = JSON.parse(validTargetAreas);\r\n\t\t\t\t\t\tif (validTargetAreas && typeof validTargetAreas === 'object') {\r\n\t\t\t\t\t\t\tjQuery('.modularity-sidebar-area').each(function (\r\n\t\t\t\t\t\t\t\tindex,\r\n\t\t\t\t\t\t\t\tsidebar\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t!validTargetAreas.includes(jQuery(this).attr('data-area-id'))\r\n\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\tjQuery(this)\r\n\t\t\t\t\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t\t\t\t\t.removeClass('modularity-incompatible-area');\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tjQuery(this)\r\n\t\t\t\t\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t\t\t\t\t.addClass('modularity-incompatible-area');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.log('Incompability information not defined - ' + error);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tstop(e, ui) {\r\n\t\t\t\t\tconst sidebarId = ui.item.parents('ul').data('area-id');\r\n\t\t\t\t\tui.item\r\n\t\t\t\t\t\t.find('input[name^=\"modularity_modules\"]')\r\n\t\t\t\t\t\t.each(function (index, element) {\r\n\t\t\t\t\t\t\tconst newName = $(this)\r\n\t\t\t\t\t\t\t\t.attr('name')\r\n\t\t\t\t\t\t\t\t.replace(/\\[(.*?)\\]/i, '[' + sidebarId + ']');\r\n\t\t\t\t\t\t\t$(this).attr('name', newName);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tjQuery('[id^=modularity-mb-]').removeClass(\r\n\t\t\t\t\t\t'modularity-incompatible-area'\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t\t.bind(this);\r\n\t};\r\n\r\n\t/**\r\n\t * Setup draggable functionallity\r\n\t *\r\n\t * @return {void}\r\n\t */\r\n\tDragAndDrop.prototype.setupDraggable = function () {\r\n\t\t$('.modularity-js-draggable').draggable({\r\n\t\t\tappendTo: 'body',\r\n\t\t\tcontainment: 'document',\r\n\t\t\tscroll: false,\r\n\t\t\thelper: 'clone',\r\n\t\t\trevert: 'invalid',\r\n\t\t\trevertDuration: 200,\r\n\t\t\tstart(event, ui) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet validTargetAreas = jQuery(this).attr(\r\n\t\t\t\t\t\t'data-sidebar-incompability'\r\n\t\t\t\t\t);\r\n\t\t\t\t\tvalidTargetAreas = JSON.parse(validTargetAreas);\r\n\r\n\t\t\t\t\tif (validTargetAreas && typeof validTargetAreas === 'object') {\r\n\t\t\t\t\t\tjQuery('.modularity-sidebar-area').each(function (index, sidebar) {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t!validTargetAreas.includes(jQuery(this).attr('data-area-id'))\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tjQuery(this)\r\n\t\t\t\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t\t\t\t.removeClass('modularity-incompatible-area');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tjQuery(this)\r\n\t\t\t\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t\t\t\t.parent()\r\n\t\t\t\t\t\t\t\t\t.addClass('modularity-incompatible-area');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.log('Incompability information not defined - ' + error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tstop(event, ui) {\r\n\t\t\t\tjQuery('[id^=modularity-mb-]').removeClass(\r\n\t\t\t\t\t'modularity-incompatible-area'\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t * Setup droppable functionallity\r\n\t *\r\n\t * @return {void}\r\n\t */\r\n\tDragAndDrop.prototype.setupDroppable = function () {\r\n\t\t$('.modularity-js-droppable')\r\n\t\t\t.droppable({\r\n\t\t\t\taccept: '.modularity-js-draggable',\r\n\t\t\t\thoverClass: 'modularity-state-droppable',\r\n\t\t\t\tdrop: function (e, ui) {\r\n\t\t\t\t\tthis.appendModule(e, ui);\r\n\t\t\t\t}.bind(this),\r\n\t\t\t})\r\n\t\t\t.bind(this);\r\n\t};\r\n\r\n\t/**\r\n\t * Appends a module to the target when dropped\r\n\t *\r\n\t * @param  {Object} e  Event\r\n\t * @param  {Object} ui UI\r\n\t * @return {void}\r\n\t */\r\n\tDragAndDrop.prototype.appendModule = function (e, ui) {\r\n\t\tconst module = ui.draggable;\r\n\t\tconst moduleName = module.find('.modularity-module-name').text();\r\n\t\tconst moduleId = module.data('module-id');\r\n\t\tconst incompability = module.attr('data-sidebar-incompability');\r\n\r\n\t\tModularity.Editor.Module.addModule(\r\n\t\t\te.target,\r\n\t\t\tmoduleId,\r\n\t\t\tmoduleName,\r\n\t\t\tundefined,\r\n\t\t\tundefined,\r\n\t\t\tundefined,\r\n\t\t\tundefined,\r\n\t\t\tundefined,\r\n\t\t\tincompability\r\n\t\t);\r\n\t};\r\n\r\n\treturn new DragAndDrop();\r\n})(jQuery);\r\n","/* eslint-disable camelcase */\r\n/* eslint-disable no-undef */\r\n/* eslint-disable no-implicit-globals */\r\nexport default (function ($) {\r\n\tfunction Autosave() {\r\n\t\t$(function () {\r\n\t\t\t// this.handleEvents();\r\n\t\t});\r\n\t}\r\n\r\n\tAutosave.prototype.save = function (selector) {\r\n\t\t$('#modularity-options #publishing-action .spinner').css(\r\n\t\t\t'visibility',\r\n\t\t\t'visible'\r\n\t\t);\r\n\t\tconst request = $(selector).serializeObject();\r\n\t\trequest.id = modularity_post_id;\r\n\t\trequest.action = 'save_modules';\r\n\r\n\t\t$.post(ajaxurl, request, function () {\r\n\t\t\t$('#modularity-options #publishing-action .spinner').css(\r\n\t\t\t\t'visibility',\r\n\t\t\t\t'hidden'\r\n\t\t\t);\r\n\t\t});\r\n\t};\r\n\r\n\treturn new Autosave();\r\n})(jQuery);\r\n","/* eslint-disable sort-imports */\r\n/* eslint-disable no-use-before-define */\r\n/* eslint-disable no-var */\r\n/* eslint-disable no-undef */\r\nimport Modal from './prompt/modal';\r\nimport Widget from './helpers/widget';\r\nimport Helpers from './helpers/helpers';\r\nimport Validate from './editor/validate';\r\nimport Thickbox from './editor/thickbox';\r\nimport Module from './editor/module';\r\nimport DragAndDrop from './editor/dragAndDrop';\r\nimport Autosave from './editor/autosave';\r\n\r\nvar Modularity = Modularity || {};\r\nModularity.Prompt = {Modal};\r\nModularity.Helpers = Helpers;\r\nModularity.Helpers.Widget = Widget;\r\nModularity.Editor = {Validate, Thickbox, Module, DragAndDrop, Autosave};\r\n\r\n(function ($) {\r\n\t$('input[type=\"checkbox\"].sidebar-area-activator').on('click', function (e) {\r\n\t\tconst isChecked = $(this).is(':checked');\r\n\t\tconst value = $(this).attr('value');\r\n\t\talert(1);\r\n\t\tif (e.shiftKey) {\r\n\t\t\tif (!isChecked) {\r\n\t\t\t\t$(\r\n\t\t\t\t\t'input.sidebar-area-activator[type=\"checkbox\"][value=\"' + value + '\"]'\r\n\t\t\t\t).attr('checked', false);\r\n\t\t\t} else {\r\n\t\t\t\t$(\r\n\t\t\t\t\t'input.sidebar-area-activator[type=\"checkbox\"][value=\"' + value + '\"]'\r\n\t\t\t\t).attr('checked', true);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n})(jQuery);\r\n\r\n(function ($) {\r\n\t// Show spinner when clicking save on Modularity options page\r\n\t$('#modularity-options #publish').on('click', function () {\r\n\t\t$(this).siblings('.spinner').css('visibility', 'visible');\r\n\t});\r\n\r\n\t// Remove the first menu item in the Modularity submenu (admin menu)\r\n\t$('a.wp-first-item[href=\"admin.php?page=modularity\"]').parent('li').remove();\r\n\r\n\t// Trigger autosave when switching tabs\r\n\t$('#modularity-tabs a').on('click', function () {\r\n\t\tif (wp.autosave) {\r\n\t\t\t$(window).unbind();\r\n\r\n\t\t\twp.autosave.server.triggerSave();\r\n\r\n\t\t\t$(document).ajaxComplete(function () {\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t});\r\n})(jQuery);\r\n\r\n/* Auto scrolling content */\r\njQuery(document).ready(function ($) {\r\n\tif ($('#modularity-mb-modules').length) {\r\n\t\tconst offset = $('#modularity-mb-modules').offset();\r\n\t\t$(document).scroll(function () {\r\n\t\t\tif (\r\n\t\t\t\t$(window).scrollTop() + 50 > offset.top &&\r\n\t\t\t\t!$('#modularity-mb-modules').hasClass('is-fixed')\r\n\t\t\t) {\r\n\t\t\t\t$('#modularity-mb-modules').addClass('is-fixed');\r\n\t\t\t} else if (\r\n\t\t\t\t$(window).scrollTop() + 50 < offset.top &&\r\n\t\t\t\t$('#modularity-mb-modules').hasClass('is-fixed')\r\n\t\t\t) {\r\n\t\t\t\t$('#modularity-mb-modules').removeClass('is-fixed');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t$('.modularity-edit-module a').on('click', function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\tModularity.Editor.Thickbox.postAction = 'edit-inline-not-saved';\r\n\t\tModularity.Prompt.Modal.open($(e.target).closest('a').attr('href'));\r\n\t});\r\n});\r\n\r\n/* Post filters is visible in backend if posttype is set to post or page */\r\njQuery(document).ready(function ($) {\r\n\t$('.frontend-filter').hide();\r\n\r\n\tif (\r\n\t\t$('#modularity-latest-post-type select').val() === 'post' ||\r\n\t\t$('#modularity-latest-post-type select').val() === 'page'\r\n\t) {\r\n\t\t$('.frontend-filter').show();\r\n\t}\r\n\t$('body')\r\n\t\t.on('change', '#modularity-latest-post-type select', function () {\r\n\t\t\tif (\r\n\t\t\t\t$('#modularity-latest-post-type select').val() === 'post' ||\r\n\t\t\t\t$('#modularity-latest-post-type select').val() === 'page'\r\n\t\t\t) {\r\n\t\t\t\t$('.frontend-filter').show();\r\n\t\t\t} else {\r\n\t\t\t\t$('.frontend-filter').hide();\r\n\t\t\t}\r\n\t\t})\r\n\t\t.trigger('change');\r\n});\r\n"]}